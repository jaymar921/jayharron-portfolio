/*
Auto-generated by: https://github.com/pmndrs/gltfjsx
*/

import React, { useEffect, useRef, useState } from "react";
import { useGLTF } from "@react-three/drei";

import WorldScene from "../assets/3d/WorldSceneFinal.glb";
import { useFrame } from "@react-three/fiber";

import { positions, smoothTransition, cubicEaseInOut } from "../constants";

const MinecraftWorld = ({
  currentStage,
  setWorldMoving,
  setWorldPosRot,
  ...props
}) => {
  const { nodes, materials } = useGLTF(WorldScene);
  const WorldRef = useRef();
  const [values, setValues] = useState(0);
  const [worldPosition, setWorldPosition] = useState([0, 0, 0]);
  const [worldRotation, setWorldRotation] = useState([0, 0, 0]);
  const [tempStage, setTempStage] = useState(-1);

  useFrame(({ clock }) => {
    const time = clock.elapsedTime; // Get the elapsed time
    const oscX = Math.sin(time * 0.5) * 0.05; // Adjust frequency and amplitude for X-axis oscillation
    const oscY = Math.cos(time * 0.4) * 0.05; // Adjust frequency and amplitude for Y-axis oscillation
    const oscZ = Math.sin(time * 0.3) * 0.03; // Adjust frequency and amplitude for Z-axis oscillation
    WorldRef.current.position.x = worldPosition[0] + oscX;
    WorldRef.current.position.y = worldPosition[1] + oscY;
    WorldRef.current.position.z = worldPosition[2] + oscZ;
    WorldRef.current.rotation.x = worldRotation[0];
    WorldRef.current.rotation.y = worldRotation[1];
    WorldRef.current.rotation.z = worldRotation[2];
    setWorldPosRot({ worldPosition, worldRotation });
  });

  useEffect(() => {
    setTimeout(() => {
      // define the easing value
      let EaseValue = cubicEaseInOut(values);
      let newPosition = undefined;
      let newRotation = undefined;

      if (currentStage === -1) {
        const { position, rotation } = smoothTransition(
          positions[4].position,
          positions[0].position,
          positions[4].rotation,
          positions[0].rotation,
          EaseValue
        );
        newPosition = position;
        newRotation = rotation;
      } else if (currentStage === 0) {
        const { position, rotation } = smoothTransition(
          positions[0].position,
          positions[1].position,
          positions[0].rotation,
          positions[1].rotation,
          EaseValue
        );
        newPosition = position;
        newRotation = rotation;
      } else if (currentStage === 1) {
        const { position, rotation } = smoothTransition(
          positions[1].position,
          positions[2].position,
          positions[1].rotation,
          positions[2].rotation,
          EaseValue
        );
        newPosition = position;
        newRotation = rotation;
      } else if (currentStage === 2) {
        const { position, rotation } = smoothTransition(
          positions[2].position,
          positions[3].position,
          positions[2].rotation,
          positions[3].rotation,
          EaseValue
        );
        newPosition = position;
        newRotation = rotation;
      } else if (currentStage === 3) {
        const { position, rotation } = smoothTransition(
          positions[3].position,
          positions[0].position,
          positions[3].rotation,
          positions[0].rotation,
          EaseValue
        );
        newPosition = position;
        newRotation = rotation;
      }

      if (values >= 1 && tempStage !== currentStage) {
        setValues(0);
      } else {
        if (values <= 1 && currentStage === tempStage) {
          setValues(values + 0.02);
          if (newPosition && newRotation) {
            setWorldPosition(newPosition);
            setWorldRotation(newRotation);
          }

          setWorldMoving(true);
        } else {
          setWorldMoving(false);
        }
      }
      setTempStage(currentStage);
    }, 40);
  }, [values, currentStage, tempStage]);

  return (
    <group {...props} ref={WorldRef}>
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive0.geometry}
        material={materials.material0}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive1.geometry}
        material={materials.material1}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive2.geometry}
        material={materials.material2}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive3.geometry}
        material={materials.material3}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive4.geometry}
        material={materials.material4}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive5.geometry}
        material={materials.material5}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive6.geometry}
        material={materials.material6}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive7.geometry}
        material={materials.material7}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive8.geometry}
        material={materials.material6}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive9.geometry}
        material={materials.material8}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive10.geometry}
        material={materials.material9}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive11.geometry}
        material={materials.material10}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive12.geometry}
        material={materials.material11}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive13.geometry}
        material={materials.material12}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive14.geometry}
        material={materials.material13}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive15.geometry}
        material={materials.material14}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive16.geometry}
        material={materials.material15}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive17.geometry}
        material={materials.material16}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive18.geometry}
        material={materials.material17}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive19.geometry}
        material={materials.material18}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive20.geometry}
        material={materials.material19}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive21.geometry}
        material={materials.material20}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive22.geometry}
        material={materials.material21}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive23.geometry}
        material={materials.material22}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive24.geometry}
        material={materials.material23}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive25.geometry}
        material={materials.material24}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive26.geometry}
        material={materials.material25}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive27.geometry}
        material={materials.material26}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive28.geometry}
        material={materials.material27}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive29.geometry}
        material={materials.material28}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive30.geometry}
        material={materials.material29}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive31.geometry}
        material={materials.material30}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive32.geometry}
        material={materials.material31}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive33.geometry}
        material={materials.material32}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive34.geometry}
        material={materials.material33}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive35.geometry}
        material={materials.material34}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive36.geometry}
        material={materials.material9}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive37.geometry}
        material={materials.material35}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive38.geometry}
        material={materials.material36}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive39.geometry}
        material={materials.material37}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive40.geometry}
        material={materials.material38}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive41.geometry}
        material={materials.material39}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive42.geometry}
        material={materials.material40}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive43.geometry}
        material={materials.material41}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive44.geometry}
        material={materials.material42}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive45.geometry}
        material={materials.material43}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive46.geometry}
        material={materials.material44}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive47.geometry}
        material={materials.material45}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive48.geometry}
        material={materials.material46}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive49.geometry}
        material={materials.material47}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive50.geometry}
        material={materials.material48}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive51.geometry}
        material={materials.material8}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive52.geometry}
        material={materials.material0}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive53.geometry}
        material={materials.material49}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive54.geometry}
        material={materials.material50}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive55.geometry}
        material={materials.material9}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive56.geometry}
        material={materials.material51}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive57.geometry}
        material={materials.material9}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive58.geometry}
        material={materials.material10}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive59.geometry}
        material={materials.material9}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive60.geometry}
        material={materials.material10}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive61.geometry}
        material={materials.material52}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive62.geometry}
        material={materials.material10}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive63.geometry}
        material={materials.material8}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive64.geometry}
        material={materials.material6}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive65.geometry}
        material={materials.material53}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive66.geometry}
        material={materials.material6}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive67.geometry}
        material={materials.material53}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive68.geometry}
        material={materials.material6}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive69.geometry}
        material={materials.material53}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive70.geometry}
        material={materials.material6}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive71.geometry}
        material={materials.material53}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive72.geometry}
        material={materials.material6}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive73.geometry}
        material={materials.material53}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive74.geometry}
        material={materials.material54}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive75.geometry}
        material={materials.material55}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive76.geometry}
        material={materials.material56}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive77.geometry}
        material={materials.material57}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive78.geometry}
        material={materials.material58}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive79.geometry}
        material={materials.material52}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive80.geometry}
        material={materials.material59}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive81.geometry}
        material={materials.material60}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive82.geometry}
        material={materials.material61}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive83.geometry}
        material={materials.material62}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive84.geometry}
        material={materials.material52}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive85.geometry}
        material={materials.material63}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive86.geometry}
        material={materials.material64}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive87.geometry}
        material={materials.material65}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive88.geometry}
        material={materials.material66}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive89.geometry}
        material={materials.material67}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive90.geometry}
        material={materials.material68}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive91.geometry}
        material={materials.material69}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive92.geometry}
        material={materials.material70}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive93.geometry}
        material={materials.material70}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive94.geometry}
        material={materials.material71}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive95.geometry}
        material={materials.material72}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive96.geometry}
        material={materials.material0}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive97.geometry}
        material={materials.material0}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive98.geometry}
        material={materials.material73}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive99.geometry}
        material={materials.material74}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive100.geometry}
        material={materials.material75}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive101.geometry}
        material={materials.material76}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive102.geometry}
        material={materials.material77}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive103.geometry}
        material={materials.material78}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive104.geometry}
        material={materials.material79}
      />
      <mesh
        castShadow
        receiveShadow
        geometry={nodes.Asset3DLoadersceneRoot_primitive105.geometry}
        material={materials.material80}
      />
    </group>
  );
};
export default MinecraftWorld;
